<div class="profile-background">

  <!-- Bloc 1 : Profil Utilisateur -->
  <section class="profile-main-block">
    <div class="profile-container">

      <!-- Bouton d'édition -->
      <div class="profile-edit-icon">
        <%= link_to edit_myprofile_path, class: "profile-edit-button" do %>
          <i class="bx bx-pencil"></i>
        <% end %>
      </div>

      <!-- Photo de profil -->
      <div class="profile-pic-container">
        <%= cl_image_tag current_user.avatar.key, alt: "Avatar utilisateur", class: "profile-avatar" %>
      </div>

      <!-- Nom de l'utilisateur -->
      <div class="profile-username">
        <h2 class="profile-title">Bonjour, <%= current_user.first_name.capitalize %> !</h2>
      </div>

      <!-- Genres préférés -->
      <div class="profile-section">
        <h3 class="profile-section-title">Vos genres préférés</h3>
        <div class="profile-genre-grid">
          <% if current_user.playlists.first&.movies.present? %>
            <% current_user.playlists.first.movies.each do |movie| %>
              <span class="profile-genre-button"><%= movie.genres.split(',').first %></span>
            <% end %>
          <% else %>
            <p class="profile-empty-message">Aucun genre préféré sélectionné</p>
          <% end %>
        </div>
      </div>

      <!-- Plateformes préférées -->
      <div class="profile-section">
        <h3 class="profile-section-title">Vos plateformes préférées</h3>
        <div class="profile-platform-grid">
          <% platforms = [] %>
          <% current_user.playlists.each do |playlist| %>
            <% playlist.movies.each do |movie| %>
              <% platforms << movie.platform if movie.platform.present? %>
            <% end %>
          <% end %>
          <% if platforms.uniq.any? %>
            <% platforms.uniq.each do |platform| %>
              <span class="profile-platform-button"><%= platform %></span>
            <% end %>
          <% else %>
            <p class="profile-empty-message">Aucune plateforme préférée sélectionnée</p>
          <% end %>
        </div>
      </div>

    </div>
  </section>

  <!-- Bloc 2 : Playlists -->
  <section class="profile-playlists-block">
    <div class="profile-container">
      <h3 class="profile-section-title">Mes playlists</h3>
      <% if current_user.playlists.present? %>
        <div class="profile-playlists-grid">
          <% current_user.playlists.each do |playlist| %>
            <div class="profile-playlist-card">
              <%= image_tag "default-playlist.png", alt: "Image Playlist", class: "profile-playlist-image" %>
              <p class="profile-playlist-name"><%= playlist.name %></p>
            </div>
          <% end %>
        </div>
      <% else %>
        <p class="profile-empty-message">Vous n'avez pas encore créé de playlists.</p>
      <% end %>
    </div>
  </section>

</div>
