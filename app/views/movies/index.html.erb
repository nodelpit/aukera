<div class="container">
  <div class="container-content">
    <%# Bouton Relancer %>
    <div class="button-light mx-auto">
      <%= link_to "Relancer", movies_path(params.permit(:duration, :services, :genres, search: :query)), class: "button-text" %>
    </div>

    <%# Section des films/séries avec condition pour l'affichage %>
    <% if @movies.present? %>
      <div class="scroll">
        <% @movies.each do |movie| %>
          <%# Icône de sauvegarde %>
          <div class="movie-card-save-icon">
            <%= link_to image_tag("Save icon.png"), movie_new_movie_to_playlist_path(movie.id), data: { turbo_frame: "_top"} %>
          </div>

          <%# Carte du film/série avec lien vers les détails %>
          <%= link_to(movie_path(movie), class: "text-decoration-none", data: {turbo_frame: "movie-modal"}) do %>
            <div class="movie-card" style="background-image: url('<%= movie.vertical_image_url %>')">
              <div class="movie-card card-gradient">
                <div class="movie-card-text">
                  <h4><%= movie.title %></h4>
                  <h6><%= movie.overview.first(100) %>...</h6>
                  <div class="movie-capsules-container">
                    <% if movie.show_type == 'series' %>
                      <div class="movie-capsule">
                        <%= movie.season_count %> <%= movie.season_count == 1 ? 'Saison' : 'Saisons' %>
                      </div>
                    <% else %>
                      <div class="movie-capsule"><%= movie.runtime %> min</div>
                    <% end %>
                    <div class="movie-capsule"><%= movie.release_year %></div>
                    <div class="movie-capsule"><%= movie.genres %></div>
                  </div>
                </div>
              </div>
            </div>
          <% end %>
        <% end %>
      </div>
    <% else %>
      <%# Message affiché quand aucun résultat n'est trouvé %>
      <div class="no-results">
        <p>Aucun résultat pour cette recherche...</p>
      </div>
    <% end %>

    <%# Section des playlists %>
    <h3>
      <%= link_to "Mes playlists", playlists_path, class: "light-text-h3 text-decoration-none" %>
    </h3>

    <div class="scroll">
      <div class="scroll-fade-right"></div>
      <div class="scroll-container">
        <%# Affichage des playlists existantes %>
        <% @playlists.each do |playlist| %>
          <div class="list-card" style="background-image: url('<%= playlist.photo.key? ? cl_image_path(playlist.photo.key) : image_path("Playlist test image.png") %>')">
            <%= link_to(playlist_path(playlist), class: "text-decoration-none") do %>
              <div class="list-card card-gradient">
                <h5><%= playlist.name %></h5>
              </div>
            <% end %>
          </div>
        <% end %>

        <%# Lien pour voir toutes les playlists %>
        <div class="list-card" style="background: transparent; box-shadow: none">
          <%= link_to(playlists_path) do %>
            <h5>Voir toutes mes playlists</h5>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>
